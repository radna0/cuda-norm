# 20B expert usage profile (GPT-OSS MoE)

- Model: `openai/gpt-oss-20b`
- Dataset: `radna0/harmony-nemotron-cpu-artifacts` split `train` col `text`
- Rows: 500
- Max seq length: 4096
- Layers: 24 | Experts: 32 | Top-k: 4
- Total tokens processed: 872,749
- Forward throughput: 4498 tokens/s
- Routed selections recorded: 83783904
- Selected-prob samples recorded: 83783904

## Top experts by layer (top 10, count)

- layer_0: [1 (252737), 9 (201568), 18 (197204), 11 (188920), 23 (177890), 24 (177819), 16 (161035), 22 (154435), 17 (153478), 21 (151382)]
- layer_1: [5 (335567), 1 (261706), 18 (246812), 0 (221080), 28 (189962), 10 (178581), 13 (166581), 27 (154163), 29 (141374), 25 (129517)]
- layer_2: [5 (357838), 22 (260171), 8 (246341), 10 (242925), 29 (181359), 28 (170531), 12 (163638), 31 (163049), 0 (150090), 24 (149988)]
- layer_3: [31 (382406), 2 (301174), 23 (292432), 7 (257367), 19 (255198), 4 (242566), 21 (220739), 1 (211915), 12 (142320), 25 (130586)]
- layer_4: [18 (550100), 14 (494479), 6 (376401), 22 (323919), 20 (191748), 10 (161797), 12 (146344), 30 (142129), 1 (126644), 24 (120126)]
- layer_5: [6 (510690), 9 (351495), 29 (343943), 31 (327060), 24 (280076), 0 (260488), 14 (237365), 17 (138538), 2 (126974), 27 (105133)]
- layer_6: [28 (311883), 10 (262892), 3 (232852), 17 (185330), 2 (184500), 14 (181731), 4 (181697), 5 (171857), 20 (170076), 21 (159659)]
- layer_7: [9 (267895), 15 (263842), 21 (234065), 24 (234055), 4 (230405), 30 (218616), 13 (175902), 19 (159623), 10 (141643), 5 (141058)]
- layer_8: [23 (342841), 31 (257558), 0 (227543), 10 (216940), 24 (215561), 13 (213043), 14 (198342), 18 (198272), 30 (188024), 8 (174168)]
- layer_9: [8 (335210), 25 (284923), 26 (267702), 13 (254176), 16 (233678), 30 (217584), 21 (216291), 0 (172611), 22 (172316), 19 (166591)]
- layer_10: [5 (717604), 15 (635743), 26 (262253), 10 (255333), 18 (200731), 19 (184642), 1 (159390), 23 (156865), 20 (154213), 8 (149191)]
- layer_11: [20 (796739), 30 (610030), 11 (308782), 1 (298938), 9 (236638), 13 (203517), 0 (172117), 26 (133833), 24 (129203), 21 (120250)]
- layer_12: [18 (508789), 12 (338415), 3 (320073), 24 (272635), 1 (255901), 10 (239922), 25 (232104), 5 (217972), 23 (172895), 21 (127568)]
- layer_13: [1 (555934), 0 (405004), 24 (298068), 23 (268299), 11 (229025), 8 (220722), 21 (181244), 19 (180494), 30 (151442), 9 (121209)]
- layer_14: [6 (410531), 7 (329887), 29 (304361), 1 (243139), 4 (215023), 9 (212730), 24 (158722), 11 (135589), 19 (128345), 22 (126185)]
- layer_15: [28 (330360), 9 (282912), 26 (270001), 31 (205356), 23 (203499), 2 (201456), 13 (189185), 0 (183855), 8 (148230), 12 (127223)]
- layer_16: [27 (311776), 11 (310810), 12 (288928), 18 (252812), 31 (251203), 21 (206668), 1 (176303), 2 (168133), 4 (162520), 22 (143760)]
- layer_17: [24 (460031), 11 (387521), 5 (350257), 7 (282462), 10 (235213), 21 (184304), 25 (144509), 16 (143590), 4 (141820), 9 (122228)]
- layer_18: [14 (341931), 30 (308968), 1 (300153), 29 (282789), 17 (189536), 15 (179890), 20 (179609), 31 (150398), 21 (149511), 26 (147568)]
- layer_19: [1 (372527), 7 (340386), 9 (302514), 22 (297463), 13 (280015), 23 (211959), 8 (185950), 6 (151655), 26 (133697), 14 (126564)]
- layer_20: [2 (457713), 1 (454342), 10 (349332), 15 (320203), 4 (276945), 31 (210420), 5 (141096), 19 (122549), 9 (94298), 21 (86299)]
- layer_21: [23 (589876), 24 (562219), 5 (331617), 30 (320751), 29 (308847), 26 (273320), 3 (143943), 11 (121394), 13 (83372), 9 (78659)]
- layer_22: [11 (631609), 9 (325601), 23 (323740), 24 (322813), 13 (264452), 2 (228893), 12 (211920), 25 (152730), 3 (140593), 27 (67747)]
- layer_23: [24 (612181), 12 (439744), 21 (428760), 13 (336231), 23 (292512), 19 (192559), 7 (169071), 4 (163786), 31 (139159), 18 (129139)]

## Artifacts

- `data/20b_expert_usage.parquet` (usage + co-activation + confidence stats)
- `data/20b_expert_ranking_by_layer.json` (for soft-prune + structural-prune followups)

## Reproduce

```bash
modal run modal/gpt_oss_pruning_track.py --task profile_20b --dataset-id radna0/harmony-nemotron-cpu-artifacts --dataset-split train --text-column text --num-rows 500 --max-seq-length 4096
```
